# Проект М2. Бильярд

## Постановка задачи

Смоделируйте столкновение идеально гладкого бильярдного шара с бесконечно тяжёлой стенкой и с другим шаром. 

Расчёт реализуйте двумя способами:

1) Рассчитайте результат абсолютно упругого удара, в явном виде применив законы сохранения;

2) Детально смоделируйте упругое столкновение, решая дифференциальное уравнение на основе 2-го закона Ньютона, если шар считать деформируемым согласно закону Гука $$F \sim -\Delta x$$ или закону Герца $$F \sim -\Delta x^{3/2}$$

Проверьте выполнение законов сохранения по результатам такого расчёта.

---

## Математическая модель

**Второй закон Ньютона:**
$$m\frac{d^2\vec{r}}{dt^2} = \vec{F}$$

**Кинетическая энергия:**
$$E = \frac{1}{2}m|\vec{v}|^2$$

**Импульс системы:**
$$\vec{P} = \sum m_i\vec{v}_i$$

**Условие столкновения:**
$$|\vec{r} - \vec{r}_{wall}| < R$$

**Закон отражения (абсолютно упругий удар):**
$$\vec{v}' = \vec{v} - 2(\vec{v} \cdot \vec{n})\vec{n}$$

где:
- $$\vec{r}$$ - вектор положения шара
- $$\vec{r}_{wall}$$ - положение стенки
- $$R$$ - радиус шара  
- $$\vec{n}$$ - нормаль к стенке
- $$\vec{v}$$ - скорость до столкновения
- $$\vec{v}'$$ - скорость после столкновения

### 3. Метод законов сохранения

**Система уравнений для двух шаров:**

**Сохранение импульса:**
$$m_1\vec{v}_1 + m_2\vec{v}_2 = m_1\vec{v}_1' + m_2\vec{v}_2'$$

**Сохранение кинетической энергии:**
$$\frac{1}{2}m_1v_1^2 + \frac{1}{2}m_2v_2^2 = \frac{1}{2}m_1v_1'^2 + \frac{1}{2}m_2v_2'^2$$

**Алгоритм решения:**

1. **Вектор нормали:**
   $$\vec{n} = \frac{\vec{r}_2 - \vec{r}_1}{|\vec{r}_2 - \vec{r}_1|}$$

2. **Относительная скорость по нормали:**
   $$v_n = (\vec{v}_2 - \vec{v}_1) \cdot \vec{n}$$

3. **Приведенная масса:**
   $$\mu = \frac{m_1 m_2}{m_1 + m_2}$$

4. **Импульс удара:**
   $$J = 2\mu v_n$$

5. **Новые скорости:**
   $$\vec{v}_1' = \vec{v}_1 + \frac{J}{m_1}\vec{n}$$
   $$\vec{v}_2' = \vec{v}_2 - \frac{J}{m_2}\vec{n}$$

### 4. Метод деформации

**Дифференциальные уравнения движения:**
$$m_1\frac{d^2\vec{r}_1}{dt^2} = \vec{F}$$
$$m_2\frac{d^2\vec{r}_2}{dt^2} = -\vec{F}$$

**Глубина проникновения:**
$$\Delta x = R_1 + R_2 - |\vec{r}_2 - \vec{r}_1|$$

**Сила взаимодействия:**

**Закон Гука:**
$$F = k\Delta x$$

**Закон Герца:**
$$F = k(\Delta x)^{3/2}$$

**Направление силы:**
$$\vec{F} = F\vec{n}$$

**Демпфирующая сила:**
$$F_{damping} = \beta v_{rel}$$
где $$\beta = 0.3\sqrt{k \cdot \min(m_1, m_2)}$$

**Общая сила:**
$$\vec{F}_{total} = \vec{F} - \vec{F}_{damping}$$

### 5. Численные методы

**Интегрирование методом Эйлера:**
$$\vec{v}(t + \Delta t) = \vec{v}(t) + \frac{\vec{F}}{m}\Delta t$$
$$\vec{r}(t + \Delta t) = \vec{r}(t) + \vec{v}(t)\Delta t$$

### 6. Контроль сохранения законов

**Относительное сохранение энергии:**
$$\eta_E = \frac{E(t)}{E(0)} \times 100\%$$

**Сохранение импульса:**
$$\Delta P = |\vec{P}(t) - \vec{P}(0)|$$

---

## Параметры системы

### Количество шаров: 1 или 2
- Требование задачи

### Параметры каждого шара:
- **Позиция x**: 100-900 (ограничения стола)
- **Позиция y**: 100-500 (ограничения стола)  
- **Скорость (vx, vy)**: ±200 (реалистичные значения для визуализации)
- **Радиус**: 10-40 (разумные размеры для отображения)
- **Масса**: 5-100 (физически осмысленные значения)

### Методы столкновений:
- **1** - Законы сохранения
- **2** - Деформация
- Для метода деформации доступны законы:
  - **1** - Гука $$F \sim -\Delta x$$
  - **2** - Герца $$F \sim -\Delta x^{3/2}$$

### Физические константы:
- Коэффициент жесткости: $$k = 3000$$
- Коэффициент демпфирования: $$\beta = 0.3\sqrt{k \cdot \min(m_1, m_2)}$$

---

## Запуск

- В своей IDE можно просто нажать на большую зеленую кнопку запуска
- ```python3 __init__.py``` в нужной директории